import nvdlib

from module import Module, Type


class SearchExploits(Module):

    def __init__(self):
        super().__init__("search_exploits",
                         ["search", "exploits", "cve"],
                         "search for exploits")

        self.add_option("KEYWORDS", "keywords (space separated)", required=True, type=Type.string)

    def run(self):
        results = nvdlib.searchCVE_V2(keywordSearch=self.keywords, verbose=False)

        for result in results:
            print("id:", result.id)
            print("published:", result.published)
            print("description:")
            for desc in result.descriptions:
                if desc.lang == "en":
                    print(desc.value.replace("\n\n", "\n").rstrip())
            print()
